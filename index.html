<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HexaHome - Swiss Housing Explorer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
  <link rel="stylesheet" href="ndviautomation.css">
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loader-container">
      <div class="loader"></div>
      <h2>Loading HexaHome</h2>
      <p>Preparing your Swiss housing data...</p>
    </div>
  </div>

  <div class="container">
    <div id="menu">
      <div class="menu-inner">
      <h4 id="toggle-cantons" class="menu-toggle">
        <span class="toggle-label">Choose Canton(s)</span>
        <span class="toggle-right">
          <button type="button" class="info-icon" aria-label="About canton selection" data-tooltip="Select the cantons whose hexagon grids you want to display on the map.">i</button>
          <span class="toggle-arrow" aria-hidden="true">‚ñæ</span>
        </span>
      </h4>
      <div id="cantons-list" class="checkbox-group" style="display: none; margin-left: 15px;">
        <label><input type="checkbox" value="1"> Z√ºrich</label>
        <label><input type="checkbox" value="2"> Bern</label>
        <label><input type="checkbox" value="3"> Luzern</label>
        <label><input type="checkbox" value="4"> Uri</label>
        <label><input type="checkbox" value="5"> Schwyz</label>
        <label><input type="checkbox" value="6"> Obwalden</label>
        <label><input type="checkbox" value="7"> Nidwalden</label>
        <label><input type="checkbox" value="8"> Glarus</label>
        <label><input type="checkbox" value="9"> Zug</label>
        <label><input type="checkbox" value="10"> Fribourg</label>
        <label><input type="checkbox" value="11"> Solothurn</label>
        <label><input type="checkbox" value="12"> Basel-Stadt</label>
        <label><input type="checkbox" value="13"> Basel-Landschaft</label>
        <label><input type="checkbox" value="14"> Schaffhausen</label>
        <label><input type="checkbox" value="15"> Appenzell Ausserrhoden</label>
        <label><input type="checkbox" value="16"> Appenzell Innerrhoden</label>
        <label><input type="checkbox" value="17"> St. Gallen</label>
        <label><input type="checkbox" value="18"> Graub√ºnden</label>
        <label><input type="checkbox" value="19"> Aargau</label>
        <label><input type="checkbox" value="20"> Thurgau</label>
        <label><input type="checkbox" value="21"> Ticino</label>
        <label><input type="checkbox" value="22"> Vaud</label>
        <label><input type="checkbox" value="23"> Valais</label>
        <label><input type="checkbox" value="24"> Neuch√¢tel</label>
        <label><input type="checkbox" value="25"> Geneva</label>
        <label><input type="checkbox" value="26"> Jura</label>
      </div>

  <h4 id="toggle-opacity" class="menu-toggle">
    <span class="toggle-label">Hexagon Opacity</span>
    <span class="toggle-right">
      <button type="button" class="info-icon" aria-label="About hexagon opacity" data-tooltip="Adjust the transparency of the hexagon layer to reveal more or less of the basemap.">i</button>
      <span class="toggle-arrow" aria-hidden="true">‚ñæ</span>
    </span>
  </h4>
  
  <div id="opacity-container" style="display: none; padding: 15px 20px; background: white;">
    <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); padding: 14px; border-radius: 10px; border: 2px solid rgba(102, 126, 234, 0.3);">
      <label style="display: block; margin-bottom: 8px; font-size: 14px; font-weight: 600; color: #495057;">
        Opacity: <span id="hexagon-opacity-value" style="font-weight: 700; color: #667eea;">0.70</span>
      </label>
      <input type="range" id="hexagon-opacity-slider" min="0" max="1" step="0.05" value="0.7" style="width: 100%;">
    </div>
  </div>

  <h4 id="toggle-facilities" class="menu-toggle">
    <span class="toggle-label">Show Facilities</span>
    <span class="toggle-right">
      <button type="button" class="info-icon" aria-label="About facility markers" data-tooltip="Toggle which facility markers‚Äîschools, apartments, restaurants, and supermarkets‚Äîare displayed.">i</button>
      <span class="toggle-arrow" aria-hidden="true">‚ñæ</span>
    </span>
  </h4>
  
  <div id="facilities-list" class="checkbox-group" style="display: none; margin-left: 15px;">
    <label>
      <input type="checkbox" id="show-schools" class="facility-checkbox">
      <span>üè´ Schools</span>
    </label>
    <label>
      <input type="checkbox" id="show-apartments" class="facility-checkbox">
      <span>üè† Apartments</span>
    </label>
    <label>
      <input type="checkbox" id="show-restaurants" class="facility-checkbox">
      <span>üçΩÔ∏è Restaurants</span>
    </label>
    <label>
      <input type="checkbox" id="show-supermarkets" class="facility-checkbox">
      <span>üõí Supermarkets</span>
    </label>
  </div>

  <h4 id="index" class="menu-toggle">
    <span class="toggle-label">Adjust indexes</span>
    <span class="toggle-right">
      <button type="button" class="info-icon" aria-label="About index weights" data-tooltip="Fine-tune the weight of each indicator contributing to the composite housing score.">i</button>
          <span class="toggle-arrow" aria-hidden="true">‚ñæ</span>
    </span>
  </h4>

<div id="sliders-container" style="display: flex; flex-direction: column; gap: 12px; max-width: 400px;">

  <!-- <div>
    <label for="ndvi-slider">NDVI (Vegetation): </label><br>
    <input type="range" id="ndvi-slider" min="0" max="1" step="0.01" value="0">
  </div>

  <div>
    <label for="noise-slider">Noise Levels : </label><br>
    <input type="range" id="noise-slider" min="30" max="100" step="1" value="65">
  </div>

  <div>
    <label for="road-slider">Access to public transport (by road): </label><br>
    <input type="range" id="road-slider" min="0" max="10" step="0.1" value="8">
  </div>

  <div>
    <label for="pt-slider">Access to public transport (by public transport): </label><br>
    <input type="range" id="pt-slider" min="0" max="10" step="0.1" value="3">
  </div>

  <div>
    <label for="crime-slider">Crime Rate: </label><br>
    <input type="range" id="crime-slider" min="0" max="100" step="1" value="76">
  </div>

  <div>
    <label for="rent-slider">Rent Price: </label><br>
    <input type="range" id="rent-slider" min="500" max="5000" step="50" value="3500">
  </div>

  <div>
    <label for="school-slider">Proximity to School: </label><br>
    <input type="range" id="school-slider" min="0" max="5" step="0.1" value="2.5">
  </div>

  <div>
    <label for="supermarkets-slider">Proximity to Supermarkets (km): </label><br>
    <input type="range" id="supermarkets-slider" min="0" max="5" step="0.1" value="5">
  </div>

  <div>
    <label for="restaurants-slider">Proximity to Restaurants (km): </label><br>
    <input type="range" id="restaurants-slider" min="0" max="5" step="0.1" value="1">
  </div>

  <div>
    <label for="employability-slider">Employability (%): </label><br>
    <input type="range" id="employability-slider" min="0" max="100" step="1" value="2">
  </div> -->

    </div>
  </div>
</div>

    <div id="map"></div>
    
    <div class="map-title">
      <h1>üè† HexaHome</h1>
      <p>Swiss Housing Quality Explorer</p>
    </div>
    
    <div class="legend">
      <div class="legend-title">üìä Quality Score</div>
      <div class="legend-item">
        <div class="legend-color" style="background: #00ff00;"></div>
        <span>Excellent (80-100%)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #bfff00;"></div>
        <span>Good (60-80%)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #ffff00;"></div>
        <span>Average (40-60%)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #ff8000;"></div>
        <span>Below Avg (20-40%)</span>
      </div>
      <div class="legend-item">
        <div class="legend-color" style="background: #ff0000;"></div>
        <span>Poor (0-20%)</span>
      </div>
    </div>
    
    <div id="chatbot" class="chatbot">
      <button id="chatbot-toggle" class="chatbot-toggle" aria-expanded="false" aria-controls="chatbot-panel" title="Open housing assistant">üí¨</button>
      <div id="chatbot-panel" class="chatbot-panel" hidden>
        <header class="chatbot-header">
          <div>
            <h3>HexaHome Guide</h3>
            <p>Ask for housing stats or tips.</p>
          </div>
          <button id="chatbot-close" class="chatbot-close" type="button" aria-label="Close chat">√ó</button>
        </header>
        <div id="chatbot-messages" class="chatbot-messages" role="log" aria-live="polite"></div>
        <form id="chatbot-form" class="chatbot-form" autocomplete="off">
          <input id="chatbot-input" name="chatbot-input" type="text" placeholder="Ask about rent, cantons, or good spots..." required />
          <button type="submit" class="chatbot-send">Send</button>
        </form>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/geotiff"></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
  <script src="https://d3js.org/topojson.v2.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://unpkg.com/georaster/dist/georaster.browser.min.js"></script>
  <script src="https://unpkg.com/georaster-layer-for-leaflet/dist/georaster-layer-for-leaflet.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/6.7.0/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.8.0/proj4.js"></script>
  <script src="https://unpkg.com/georaster-layer-for-leaflet"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
  <script src="ndviautomation.js"></script>
</body>
</html>